老规矩先上结论：

### 不存在百分百防封的脚本

### 不存在百分百防封的脚本

### 不存在百分百防封的脚本

凡是说能保证不被黑的脚本，纯纯扯淡

~~~tex
弱小不是生存的障碍 傲慢才是
~~~

不能妄想个体对抗厂家的顶尖团队

但是

***

## 我们的脚本是非常安全的

## 🍉前置基础

感谢aicezam[🧙‍♂️关于脚本采用的防检测算法说明 · Issue #45 · aicezam/SmartOnmyoji (github.com)](https://github.com/aicezam/SmartOnmyoji/issues/45)

非常推荐先去看一看

##### 1. 区别外挂和脚本

+ 在这方面的学术很少有研究，外挂的定义为：“未经官方许可的，可以达到游戏作弊效果的游戏工具。使用这种工具，能获得其他诚实玩家无法达到、或者在短期内得到其他诚实玩家必须通过长期运行游戏才能得到的游戏结果。满足上述效果的工具，称之为“外挂”[1]。

+ 而对应的脚本并不会同外挂一样修改游戏数据，脚本属于自动化范畴的一种不单单游戏脚本，是指在游戏里面模拟人操作的工具的统称，可以简化甚至替代玩家操作，帮助玩家不用点击鼠标或者敲击键盘就可以进行游戏操作的自动功能，著名的XX精灵
+ 对于大部分玩家并不会考虑分得清两者区别，简单理解就是外挂改数据，脚本模拟人。
+ 市面上绝大部分为图色脚本，即通过获取屏幕图像来进行处理识别判断操作，模拟人的动作如点击、滑动、按键等等。图色对于厂家来说可以获取的特征信息更少，因此更加安全。图色类虽然安全，但复杂的图色问题无法处理，准确性不高，效率低下，不过在对阴阳师的需求下这些并不是问题。

##### 2.检测分类

我们把厂家的反制手段分为两类，即特征检测和行为检测

+ 特征检测也称客户端检测，客户端软件检测主要有检测玩家电脑上运行程序的进程、窗口名、界面名字、机器码和软件特征码等。举个简单的例子，一些外挂软件被黑客制作出来进行出售，如果销量比较高，用该外挂的次数比较多，那么该软件的一些特征码就会被加入黑名单，只要在运行游戏时，打开此类外挂就会提示非法。

+ 而更流行的做法是行为检测，即对用户交互的行为进行分析，下面重点分析

## 🍗厂家的反制手段

+ 建立一套分级检测机制

  + [2]  CN104217156A

  ![image-20230129001540493](https://runhey-img-stg1.oss-cn-chengdu.aliyuncs.com/img2/image-20230129001540493.png)

  这个是14年扒出来的，很难不推断出网易可以建立诸如从初筛，次筛，分层判断的流程。从成本角度考虑，筛选是非为脚本玩家，跑模型是对每一个玩家依次进行，海量的玩家有海量的数据及对应的成本增加，这其实是一件吃力不讨好的事情，印象中19年和20年是有的比较大力度的打击，当然厂家并不会赶尽杀绝只是保持一个度而已

  这个可以解释为什么会有low的脚本可以声称用了多少多少久不被抓

  + 可行的具体猜想有，对在线时间比较长玩家划分一个层次，对肝度（体力、金币、勾玉等等）玩家也建立一个层级，一个咸鱼玩家本来每天上线领一领东西然后突然爆肝，一天肝了多少千体力，你猜猜网易会不会特别关照一下。

+ 点击位置聚类

  + [3] CN114712861A

  ![image-20230129121052896](https://runhey-img-stg1.oss-cn-chengdu.aliyuncs.com/img2/image-20230129121052896.png)

  说白了就是单位时间内对点击位置进行分类，可以分出多少个点诸如此

+ 时序动作输入模型

  + [4] CN114832384A
  + ![image-20230129132938565](https://runhey-img-stg1.oss-cn-chengdu.aliyuncs.com/img2/image-20230129132938565.png)
  + 触控类型：点击、多点击、长按、拖动、滑动等等是针对智能手机而言
  + **触控类型序列**
  + **触控位置序列**


## 🍤我们的措施

### 环境隔离：直接断绝特征检测

![uowl环境架构](https://runhey-img-stg1.oss-cn-chengdu.aliyuncs.com/img2/uowl%E7%8E%AF%E5%A2%83%E6%9E%B6%E6%9E%84.png)

我们认为虽然大多数厂家更加倾向于行为检测，但是并不排除使用检测设备信息进而判定非法作弊，因此在项目最初直接pass以手机app形式的脚本控制游戏，转而实现电脑端隔离，同时这也是作者推荐选用雷电模拟器原因之一

### 一切为了模拟人

再次感谢aicezam

##### 多任务-正常人不会连续几小时去肝御魂

+ 我们的任务体系是全自动运行的
+ 我们的任务类别多种多样
+ 我们的任务时长符合正常人
+ 我们的任务可以自行设置时间
+ 我们还提供界面自行编辑任务

##### 多触控类型-玩游戏总不能只点击

+ 提供单点和多点 点击操作
+ 滑动操作(截至2023.1.29还未实现)

##### 时间间隔无规律-人类交互行为不会总那么稳定

+ 每个任务interal time 都不固定短的有0.8s长的有5s
+ 在每个interal time基础上又有±0.5s的随机偏正
+ 每个任务实际运行时间并不等同于标定运行时间，具有一定的滞后性

##### 点击操作原子化-更少的特征

+ 点击间隔随机0.1~0.2s
+ 二维高斯分布
+ 有多种的分布范围，高斯分布范围可高度450x450像素点足够覆盖半个屏幕
+ 针对部分游戏界面，进行大范围偏移

##### 滑动操作原子化-更少的特征

+ 可以先看看这篇文章

+ [机器鼠标轨迹识别（应用场景：反爬虫、网络考试安防） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/524626780)

## 🥠我们的建议

+ 我们从不认为可以完全对抗检测机制
+ 建议选择 雷电模拟器  window后台
+ 使用时间切近自身手动时间，循序渐进
+ 对于高强度挂机党推荐选择**aicezam/SmartOnmyoji**
+ 如有不完善之处还请不吝指教

## 🍩参考资料

###### [1] 何迎生,段明秀.32 位 Windows 系统下的 PE 文件结构及其应用.吉首大学学报(自然科学版),2003,24(1):77-79.

###### [2] CN104217156A

###### [3] CN114712861A

###### [4] CN114832384A

###### [5] [机器鼠标轨迹识别（应用场景：反爬虫、网络考试安防） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/524626780)

###### [6] 网络游戏外挂与反外挂技术的研究与应用-刘闯



